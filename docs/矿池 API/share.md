# 算力数据

获取单个用户某个时间维度的总体算力数据，以及单个 worker 的算力数据。

## 获取实时算力

`GET /worker/share/summary/`

获取实时算力数据。如果您在考虑编写一个算力监控系统，可以考虑使用该 API。

### 参数

无

### 返回值

    {
        "unit" : "G",    --- 经过格式化的算力单位
        "1m" : "787.9",  --- 最近 1 分钟算力
        "5m" : "157.5",  --- 最近 5 分钟算力
        "15m" : "599.8", --- 最近 15 分钟算力
        "avg" : "599.800",  --- 15 分钟算力平均单台矿机算力
        "count" : "1" --- 在线矿机数
    }









## 获取矿机算力分布

`GET /worker/share/distribution/`

获取用户矿机在不同算力区间内的分布情况。

### 参数

|名称|类型|说明|
|---|----|----|
|dimension|str|必须，指定算力数据的时间维度，可选值为`(1m/5m/15m)`，分别对应 1 分钟、5 分钟、15 分钟的算力数据。推荐使用 15m 数据。|

### 返回值

    {
        "sharesMax" : 599.8,    --- 最大算力
        "sharesAvg" : "599.800",   --- 平均算力
        "sharesMin" : 599.8,   --- 最小算力
        "shareDistribution" :  --- 算力分布横轴，标识着算力不同的区间
           [ "0.00", "12.00", "23.99", "35.99", "47.98", "59.98", "71.98", "83.97", "95.97", "107.96", "119.96", "131.96", "143.95", "155.95", "167.94", "179.94", "191.94", "203.93", "215.93", "227.92", "239.92", "251.92", "263.91", "275.91", "287.90", "299.90", "311.90", "323.89", "335.89", "347.88", "359.88", "371.88", "383.87", "395.87", "407.86", "419.86", "431.86", "443.85", "455.85", "467.84", "479.84", "491.84", "503.83", "515.83", "527.82", "539.82", "551.82", "563.81", "575.81", "587.80", "599.80", "611.80", "623.79", "635.79" ],
        "shareCount" :   --- 算力分布纵轴，标识着不同算力区间分布的 worker 数量
           [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0 ],
        "sharesUnit" : "G",   --- 经过格式化的算力单位
        "totalCount" : 1    --- 在线矿机数
    }








## 获取用户算力历史数据

`GET /worker/share/`

获取用户算力的历史数据。目前可用时间维度为 5 分钟、15 分钟和 1 小时，目前这三个维度的数据在服务器端保留 30 天。

### 参数

|名称|类型|说明|
|---|----|----|
|dimension|str|必须，指定算力数据的时间维度，可选值为`(5m/15m/1h)`，分别对应 5 分钟、15 分钟、1 小时的算力数据|
|start_ts|int|必须，指定算力数据开始的时间戳；若为负数，则从调用时间减去该值做为返回数据的起始时间|
|count|int|必须，指定最多返回多少个时间点的数据，如果返回值在指定时间点没有数据，则为 null|

### 返回值

**注意**：share 字段下的时间戳，均为时间区间的**结束点**，而非**开始点**。

    {
        "unit" : "T",        --- 算力单位
        "share" : {
            "1421375400" : {        --- 该数据所在时间区间的结束时间戳
                "reject" : "0.029",  --- 拒绝值（即有效算力）
                "accept" : "1.477"   --- 接受值
            },
            "1421375460" : null     --- 该时间点暂无数据
        }
    }

### 示例

#### 获取 15 分钟维度、最近 1 小时（3600秒）的算力数据

##### 请求

`https://www.tangpool.com/public/worker/share/?count=4&dimension=15m&start_ts=-3600&__access_key__=eKozz7vGMHfNuUsIJPHRMkq8EcQ0R9P3`
    
##### 返回
        
    {
       "unit" : "T",
       "share" : {
          "1421376300" : {
             "accept" : "1.242",
             "reject" : "0.078"
          },
          "1421377200" : {
             "reject" : "0.000",
             "accept" : "1.272"
          },
          "1421375400" : {
             "accept" : "1.477",
             "reject" : "0.029"
          },
          "1421374500" : {
             "reject" : "0.019",
             "accept" : "1.145"
          }
       }
    }


#### 获取 5 分钟维度、最近 3 小时（10800秒）的算力数据

##### 请求

```
https://www.tangpool.com/public/worker/share/?count=36&dimension=5m&start_ts=-10800&__access_key__=eKozz7vGMHfNuUsIJPHRMkq8EcQ0R9P3
```    

##### 返回

    {
       "unit" : "T",
       "share" : {
          "1421372100" : {
             "accept" : "1.086",
             "reject" : "0.029"
          },
          "1421368500" : {
             "accept" : "1.409",
             "reject" : "0.000"
          },
          "1421371800" : {
             "reject" : "0.175",
             "accept" : "1.174"
          },
          "1421370000" : {
             "accept" : "1.702",
             "reject" : "0.000"
          },
          "1421376600" : {
             "reject" : "0.146",
             "accept" : "1.144"
          },
          "1421367300" : {
             "accept" : "1.467",
             "reject" : "0.000"
          },
          "1421370900" : {
             "accept" : "1.350",
             "reject" : "0.000"
          },
          "1421373300" : {
             "accept" : "1.291",
             "reject" : "0.117"
          },
          "1421375700" : {
             "reject" : "0.000",
             "accept" : "1.320"
          },
          "1421367600" : {
             "accept" : "1.702",
             "reject" : "0.234"
          },
          "1421373600" : {
             "accept" : "1.643",
             "reject" : "0.000"
          },
          "1421375400" : {
             "reject" : "0.087",
             "accept" : "1.467"
          },
          "1421374200" : {
             "reject" : "0.087",
             "accept" : "1.438"
          },
          "1421376000" : {
             "accept" : "1.643",
             "reject" : "0.000"
          },
          "1421372700" : {
             "reject" : "0.000",
             "accept" : "1.584"
          },
          "1421374500" : {
             "reject" : "0.029",
             "accept" : "1.380"
          },
          "1421373000" : {
             "accept" : "1.497",
             "reject" : "0.000"
          },
          "1421369400" : {
             "reject" : "0.146",
             "accept" : "1.262"
          },
          "1421367000" : {
             "accept" : "1.643",
             "reject" : "0.087"
          },
          "1421368800" : {
             "reject" : "0.058",
             "accept" : "1.409"
          },
          "1421370600" : {
             "reject" : "0.117",
             "accept" : "1.291"
          },
          "1421369700" : {
             "accept" : "1.409",
             "reject" : "0.000"
          },
          "1421376900" : {
             "accept" : "1.232",
             "reject" : "0.000"
          },
          "1421369100" : {
             "accept" : "1.468",
             "reject" : "0.000"
          },
          "1421372400" : {
             "reject" : "0.000",
             "accept" : "1.027"
          },
          "1421373900" : {
             "reject" : "0.000",
             "accept" : "1.262"
          },
          "1421374800" : {
             "accept" : "1.203",
             "reject" : "0.029"
          },
          "1421371500" : {
             "accept" : "1.349",
             "reject" : "0.000"
          },
          "1421370300" : {
             "reject" : "0.000",
             "accept" : "1.496"
          },
          "1421371200" : {
             "reject" : "0.000",
             "accept" : "1.760"
          },
          "1421366700" : {
             "accept" : "0.998",
             "reject" : "0.000"
          },
          "1421368200" : {
             "accept" : "1.233",
             "reject" : "0.000"
          },
          "1421375100" : {
             "reject" : "0.000",
             "accept" : "0.851"
          },
          "1421367900" : {
             "reject" : "0.058",
             "accept" : "1.467"
          },
          "1421376300" : {
             "reject" : "0.087",
             "accept" : "1.350"
          },
          "1421377200" : {
             "reject" : "0.000",
             "accept" : "0.998"
          }
       }
    }





## 获取矿机列表

**注意**：该 API 目前尚不稳定，接口可能会有变动。

`GET /worker/{cat}/`

  * cat

    矿机排序分类，目前分为 4 类：`online` - 最新上线、`offline` - 最近掉线、`minimum_share` - 最小算力和 `inactive` 非活跃矿机，一般使用 `online` 即可。

获取某个用户所属的矿机列表。

### 参数

|名称|类型|说明|
|---|----|----|
|page|int|可选，页码，默认为 1。|
|filter|str|可选，按照名称过滤|

### 返回值

    {
       "totalCount" : 9,    --- 总数量
       "totalPage" : 1,  --- 总页码
       "currentPageSize" : 50,  --- 当前分页大小
       "data" : [
          {
             "reject_percent" : "0.86",      --- 拒绝率
             "last_showup_time" : "2014-12-11 08:50:48",    --- 最后上线时间
             "agent_id" : "0",
             "min_diff" : "65536",     --- 算力难度
             "last_share_time" : "2014-12-11 11:36:43",     --- 最后上报算力时间
             "worker_name" : "s99",  --- 矿机名称
             "last_ip" : "0.0.0.0",  --- 矿机 IP
             "is_cleaning" : "0",  --- 是否正在清理该矿机的数据
             "total_reject" : "345376",  --- 总拒绝数
             "shares_5m" : "0.000",  --- 5 分钟算力
             "shares_15m" : "0.000",  --- 15 分钟算力
             "user_id" : "18",  --- 用户 id
             "total_accept" : "40016368",   --- 总接受数
             "worker_name_ip" : "0",
             "mining_worker_id" : "1",  -- worker id
             "unit" : "K",  -- 格式化后的算力单位
             "shares_1m" : "0.000"  -- 1分钟算力
          }
       ],
       "currentPage" : 1  -- 当前页码
    }





## 单个矿机的详细信息

`GET /worker/{worker_id}/`

  * worker_id

    矿机 id，可以从矿工列表 API 获取。

### 参数

无

### 返回值

    {
       "reject_percent" : "0.86",      --- 拒绝率
       "last_showup_time" : "2014-12-11 08:50:48",    --- 最后上线时间
       "agent_id" : "0",
       "min_diff" : "65536",     --- 算力难度
       "last_share_time" : "2014-12-11 11:36:43",     --- 最后上报算力时间
       "worker_name" : "s99",  --- 矿机名称
       "last_ip" : "0.0.0.0",  --- 矿机 IP
       "is_cleaning" : "0",  --- 是否正在清理该矿机的数据
       "total_reject" : "345376",  --- 总拒绝数
       "shares_5m" : "0.000",  --- 5 分钟算力
       "shares_15m" : "0.000",  --- 15 分钟算力
       "user_id" : "18",  --- 用户 id
       "total_accept" : "40016368",   --- 总接受数
       "worker_name_ip" : "0",
       "mining_worker_id" : "1",  -- worker id
       "unit" : "K",  -- 格式化后的算力单位
       "shares_1m" : "0.000"  -- 1分钟算力
    }




## 单个矿机的算力数据

`GET /worker/{worker_id}/share/`

  * worker_id

    矿机 id，可以从矿工列表 API 获取。

### 参数

|名称|类型|说明|
|---|----|----|
|dimension|str|必须，指定算力数据的时间维度，可选值为`(5m/15m/1h)`，分别对应 5 分钟、15 分钟、1 小时的算力数据|
|start_ts|int|必须，指定算力数据开始的时间戳；若为负数，则从调用时间减去该值做为返回数据的起始时间|
|count|int|必须，指定最多返回多少个时间点的数据，如果返回值在指定时间点没有数据，则为 null|

### 返回值

**注意**：share 字段下的时间戳，均为时间区间的**结束点**，而非**开始点**。

    {
        "unit" : "T",        --- 算力单位
        "share" : {
            "1421375400" : {        --- 该数据所在时间区间的结束时间戳
                "reject" : "0.029",  --- 拒绝值（即有效算力）
                "accept" : "1.477"   --- 接受值
            },
            "1421375460" : null     --- 该时间点暂无数据
        }
    }